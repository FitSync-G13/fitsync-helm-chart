# Global configuration
global:
  imageRegistry: "074094370475.dkr.ecr.us-east-2.amazonaws.com"
  imageTag: "latest"
  imagePullPolicy: Always
  environment: "production"

# Global environment variables (only for shared values)
env:
  JWT_EXPIRY: "15m"
  JWT_REFRESH_EXPIRY: "7d"
  RATE_LIMIT_WINDOW_MS: "900000"
  RATE_LIMIT_MAX_REQUESTS: "100"

# Service configurations
services:
  userService:
    name: user-service
    port: 3001
    replicas: 1
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"
  
  trainingService:
    name: training-service
    port: 3002
    replicas: 1
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"
  
  scheduleService:
    name: schedule-service
    port: 8003
    replicas: 1
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"
  
  progressService:
    name: progress-service
    port: 8004
    replicas: 1
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"
  
  notificationService:
    name: notification-service
    port: 3005
    replicas: 1
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"
  
  apiGateway:
    name: api-gateway
    port: 4000
    replicas: 1
    resources:
      requests:
        memory: "256Mi"
        cpu: "250m"
      limits:
        memory: "512Mi"
        cpu: "500m"

# Istio configuration
istio:
  gateway:
    name: "{{ .Values.global.environment }}-gateway"  # Dynamic based on environment
    namespace: "istio-system"
  
  virtualService:
    name: "fitsync-api"
    hosts:
      - "*"
    
# mTLS configuration
security:
  mtls:
    mode: STRICT

# OpenSearch logging configuration
logging:
  enabled: false  # Will be overridden by pipeline
  serviceName: "api-gateway"  # Which service to collect logs from
  opensearch:
    endpoint: "opensearch2.dev-api.fitsync.online"
    port: 9200
    protocol: "https"
    tls_verify: true
    index: "fitsync-logs"
  fluentbit:
    image: "fluent/fluent-bit:2.2.0"
    resources:
      requests:
        memory: "64Mi"
        cpu: "50m"
      limits:
        memory: "128Mi"
        cpu: "100m"
